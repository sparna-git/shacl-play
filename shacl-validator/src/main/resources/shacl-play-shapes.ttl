@prefix rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh:   <http://www.w3.org/ns/shacl#> .
@prefix xsd:  <http://www.w3.org/2001/XMLSchema#> .
@prefix shpshapes: <https://shacl-play.sparna.fr/shapes#> .
@prefix shp:  <https://shacl-play.sparna.fr/ontology#> .

shpshapes:ClosedGraphShape a sh:NodeShape ;
	# applies to every subject in the input graph
	sh:target [
		sh:select "SELECT $this WHERE { $this ?p ?o }";
	] ;
	# every triple subject must be matched by at least one shape
	sh:property [
		sh:path [ sh:inversePath shp:hasFocusNode ] ;
		sh:minCount 1 ;
		sh:message "Node was not matched by any shape" ;
	] ;
.

shpshapes:AtLeastOneFocusNodeShape a sh:NodeShape ;
	# applies to every shape that has a target definition
	sh:targetSubjectsOf sh:targetNode, sh:targetClass, sh:targetSubjectsOf, sh:targetObjectsOf;
	sh:target [
		sh:select "SELECT $this WHERE { $this a <http://www.w3.org/ns/shacl#NodeShape> ; a <http://www.w3.org/2000/01/rdf-schema#Class> }"
	] ;
	sh:target [
		sh:select "SELECT $this WHERE { $this a <http://www.w3.org/ns/shacl#NodeShape> ; a <http://www.w3.org/2002/07/owl#Class> }"
	] ;
	# every shape that has a target definition must have matched at least one focus node
	sh:property [
		sh:path shp:hasFocusNode ;
		sh:minCount 1 ;
		sh:message "Shape did not match any node in the data" ;
	]